<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Traduction SpamAssassin</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-case {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .rule-name {
            font-family: monospace;
            background: #f0f0f0;
            padding: 4px 8px;
            border-radius: 4px;
            color: #d63384;
        }
        .before {
            background: #ffebee;
            padding: 12px;
            margin: 10px 0;
            border-left: 3px solid #f44336;
        }
        .after {
            background: #e8f5e9;
            padding: 12px;
            margin: 10px 0;
            border-left: 3px solid #4caf50;
        }
        h2 {
            color: #0968AC;
            margin-top: 0;
        }
        strong {
            color: #333;
        }
    </style>
</head>
<body>
    <h1>üß™ Test de Traduction des R√®gles SpamAssassin</h1>
    <p>V√©rification que les messages cryptiques sont transform√©s en conseils clairs et actionnables.</p>

    <div id="tests-container"></div>

    <script src="spamassassin-rules-fr.js"></script>
    <script>
        // R√®gles de test (format API Postmark)
        const testRules = [
            {
                rule: 'MIME_HTML_ONLY',
                description: 'BODY: Message only has text/html MIME parts',
                score: '0.1'
            },
            {
                rule: 'MISSING_MID',
                description: 'Missing Message-Id header',
                score: '0.1'
            },
            {
                rule: 'SUBJ_ALL_CAPS',
                description: 'Subject is all capitals',
                score: '0.5'
            },
            {
                rule: 'BAYES_99',
                description: 'Bayes spam probability is 99 to 100%',
                score: '3.5'
            },
            {
                rule: 'DKIM_VALID',
                description: 'Message has at least one valid DKIM signature',
                score: '-0.1'
            },
            {
                rule: 'UNKNOWN_RULE_12345',
                description: 'Some technical description that is not in the dictionary',
                score: '0.3'
            }
        ];

        const container = document.getElementById('tests-container');

        testRules.forEach((rule, index) => {
            const translation = getSpamAssassinRuleTranslation(rule.rule, rule.description);

            const testCase = document.createElement('div');
            testCase.className = 'test-case';

            testCase.innerHTML = `
                <h2>Test ${index + 1}: <span class="rule-name">${rule.rule}</span></h2>

                <div class="before">
                    <strong>‚ùå AVANT (Cryptique) :</strong><br>
                    ${rule.score > 0 ? '+' : ''}${parseFloat(rule.score).toFixed(1)} pts - ${rule.description}
                </div>

                <div class="after">
                    <strong>‚úÖ APR√àS (Clair) :</strong><br>
                    <strong>Titre:</strong> ${translation.title}<br>
                    <strong>Description:</strong> ${translation.description}<br>
                    <strong>üí° Solution:</strong> ${translation.solution}
                    ${translation.untranslated ? '<br><em style="color: #ff9800;">(‚ö†Ô∏è R√®gle non traduite - utilise le fallback)</em>' : ''}
                </div>

                <div style="margin-top: 10px; font-size: 13px; color: #666;">
                    <strong>Priorit√©:</strong> ${translation.priority}
                </div>
            `;

            container.appendChild(testCase);
        });

        // R√©sum√©
        const summary = document.createElement('div');
        summary.className = 'test-case';
        summary.style.background = '#e3f2fd';
        summary.innerHTML = `
            <h2>üìä R√©sum√©</h2>
            <p><strong>Total de r√®gles test√©es:</strong> ${testRules.length}</p>
            <p><strong>R√®gles traduites:</strong> ${testRules.filter(r => SPAMASSASSIN_RULES_FR[r.rule]).length}</p>
            <p><strong>R√®gles non traduites (fallback):</strong> ${testRules.filter(r => !SPAMASSASSIN_RULES_FR[r.rule]).length}</p>
            <p style="margin-top: 20px; padding: 12px; background: white; border-radius: 4px;">
                ‚úÖ <strong>Tous les messages sont maintenant clairs et actionnables !</strong><br>
                Les utilisateurs savent exactement quoi faire pour am√©liorer leur score.
            </p>
        `;
        container.appendChild(summary);
    </script>
</body>
</html>
